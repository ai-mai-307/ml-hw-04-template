# ml-hw-04-template

На четвертой лекции мы разобрали деревья решений, бэггинг, случайный лес и градиентный бустинг. В этом задании вы примените пайплайны предобработки из ПЗ №2, самостоятельно реализуете бэггинг и случайный лес (для регрессии и классификации), сравните готовые реализации градиентного бустинга из трёх библиотек (XGBoost, LightGBM, CatBoost) и проведёте корректную серию экспериментов с оценкой смещения и разброса (bias–variance).
Задачи решаются на двух наборах данных: регрессия — NYC Taxi; бинарная классификация — UK Car Accidents.

# Постановка задачи

1. **Перености пайплайны предобработкииз ПЗ №2:** сохраните и подключите ваши пайплайны (например, через joblib) либо воспроизведите их кодом. Предобработка выполняется строго внутри sklearn-совместимых пайплайнов.
2. **Собственноручно реализовать алгоритмы в виде sklearn-совместимые классов**: беггинг для регрессии и классификации, случайный лес для регрессии и классификации; в базовый алгоритм -- дерево решений произвольной глубины.
3. **Сравните ваши собственноручные реализации алгоритмов с теми, которые реализованы в sklearn.**
4. **Сравните результаты решения задач с помощью беггинга и случайного леса с теми, которые обеспечивает различные реализации градиентного бустинга:**  обучите модели из **sklearn**, **XGBoost, LightGBM, CatBoost** на обеих задачах.
5. Сведите полученные результаты в электронную таблицу Google Sheet и проведите интерпретацию результатов.

## Обязательные условия

* Решение задания должно быть в блокноте **`solution.ipynb`**
* Аккуратный, надлежащий вид блокнота `solution.ipynb`
* Нет подозрений в незадекларированном использовании LLM.
* Вся предобработка — внутри пайплайнов из ПЗ №2.
* Приложена ссылка на Google таблицу с результатами экспериментов.
* Для задачии регриссии (датасет NYC) приложить результаты валидации на данных второго полугодия 2025 года. Эти данные лежат в файле `NYC_2025_h2.parquet`

Невыполнение обязательных условий означает оценивание работы в 0 баллов. У команды есть одна попытка на исправление.

## Задача №1. NYC Taxi — регрессия (5 баллов)

**Таргет:** `fare_amount`

Начисление баллов:

* **(2 балла)** Корректная собственноручная реализация и обучение беггинга и случайного леса для решения этой задачи.
* **(2 балл)** Проведено сравнение алгоритмов градиентного бустинага.
* **(1 балл)** Проведена валидация на данных `NYC_2025_h2.parquet`.

---

## Задача №2. UK Car Accidents — классификация (5 баллов)

**Таргет:** бинаризация общей тяжести аварии: `1 — со смертельным исходом`, `0 — без смертей`.

Начисление баллов:

* **(2 балла)** Корректная собственноручная реализация и обучение беггинга и случайного леса для решения этой задачи.
* **(2 балл)** Проведено сравнение алгоритмов градиентного бустинага.
* **(1 балл)** Корректная итоговая таблица экспериментов
